{"version":1,"windowDimensions":{"x":65,"y":24,"width":1301,"height":744,"maximized":true},"grammars":{"grammarOverridesByPath":{}},"project":{"deserializer":"Project","paths":["/home/iraasta/GoogleDrive/projects/esl/crawl3r"],"buffers":[{"text":"defmodule DB.Repo do\n  use Ecto.Repo, otp_app: :crawl3r\nend\n\ndefmodule DB.Project do\n  use Ecto.Model\n\t@primary_key {:number, :integer, []}\n  schema \"erlproject_git\" do\n\t\tfield :id,          :integer\n    field :name,        :string\n    field :full_name,   :string\n    field :owner_id,    :integer\n    field :html_url,    :string, primary_key: true\n    field :description, :string\n    field :languages,   :string\n    field :created_at,  :string\n    field :updated_at,  :string\n    field :pushed_at,   :string\n    field :stars,       :integer\n    field :open_issues, :integer\n    field :forks,       :integer\n    field :source,      :string\n    field :clone_url,   :string\n  end\n\tdef changeset(project, newproject) do\n\t\tcast(project, Map.from_struct(newproject), [], ~w(forks stars open_issues pushed_at updated_at clone_url))\n\tend\nend\n\ndefmodule DB.Commit do\n  use Ecto.Model\n  schema \"erlproject_commits\" do\n    field :sha,     :string, primary_key: true\n    field :author,  :string\n    field :date,    :string\n    field :url,     :string\n    field :message, :string\n    field :number,  :integer\n  end\nend\n\ndefmodule DB.Owner do\n  use Ecto.Model\n  schema \"erlproject_owner\" do\n    field :login,       :string\n    field :avatar_url,  :string\n    field :url,         :string\n  end\n\tdef changeset(owner, newowner) do\n\t\tcast(owner, Map.from_struct(newowner), ~w(url), [])\n\tend\nend\n\ndefmodule DB do\n  import Ecto.Query\n  alias DB.Project\n  alias DB.Repo\n\n\tdef put(%DB.Project{} = project) do\n\t\tquery =\tfrom p in Project,\n\t\t        where: p.id == ^project.id and p.source == ^project.source,\n\t\t\t\t\t\tselect: p\n\n\t\tcase Repo.all query do\n\t\t\t[h | []] ->\n\t\t\t\tIO.puts \"Updating #{project.name}\"\n\t\t\t\tDB.Project.changeset(h, project)\n\t\t\t\t#|> IO.inspect()\n\t\t\t\t|> Repo.update!\n\t\t\t[] ->\n\t\t\t\tIO.puts \"Inserting #{project.name}\"\n\t\t\t\tRepo.insert!(project)\n\t\tend\n\tend\n\tdef insert(%DB.Owner{} = owner) do\n\t\tquery = from o in Owner,\n\t\t        where: o.id == ^owner.id,\n\t\t        select: o\n\t\tcase Repo.all(query) do\n\t\t\t[h | []] ->\n\t\t\t\tOwner.changeset(h, owner)\n\t\t\t\t|> Repo.update!\n\t\t\t[] -> Repo.insert(owner)\n\t\tend\n\tend\nend\n","markerStore":{"nextMarkerId":15,"markersById":{"0":{"range":{"start":{"row":2,"column":0},"end":{"row":2,"column":0}},"properties":{"type":"selection","editorId":4,"goalScreenRange":null,"clip":"forward","autoscroll":false},"reversed":false,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true},"10":{"range":{"start":{"row":1,"column":0},"end":{"row":1,"column":0}},"properties":{},"reversed":false,"tailed":true,"valid":true,"invalidate":"never","maintainHistory":false},"11":{"range":{"start":{"row":57,"column":0},"end":{"row":58,"column":0}},"properties":{},"reversed":false,"tailed":true,"valid":true,"invalidate":"never","maintainHistory":false},"12":{"range":{"start":{"row":62,"column":0},"end":{"row":63,"column":0}},"properties":{},"reversed":false,"tailed":true,"valid":true,"invalidate":"never","maintainHistory":false},"13":{"range":{"start":{"row":73,"column":0},"end":{"row":74,"column":0}},"properties":{},"reversed":false,"tailed":true,"valid":true,"invalidate":"never","maintainHistory":false},"14":{"range":{"start":{"row":76,"column":0},"end":{"row":77,"column":0}},"properties":{},"reversed":false,"tailed":true,"valid":true,"invalidate":"never","maintainHistory":false}},"version":2},"history":{"version":3,"nextCheckpointId":16,"undoStack":[{"type":"group-start","snapshot":{"0":{"range":[[2,0],[2,0]],"properties":{"type":"selection","editorId":4,"goalScreenRange":null},"reversed":true,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"change","content":{"oldRange":[[2,0],[2,0]],"newRange":[[2,0],[2,2]],"oldText":"","newText":"  "}},{"type":"change","content":{"oldRange":[[2,2],[2,2]],"newRange":[[2,2],[2,3]],"oldText":"","newText":"E"}},{"type":"change","content":{"oldRange":[[2,3],[2,3]],"newRange":[[2,3],[2,4]],"oldText":"","newText":"n"}},{"type":"group-end","snapshot":{"0":{"range":[[2,4],[2,4]],"properties":{"type":"selection","editorId":4,"goalScreenRange":null},"reversed":true,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"group-start","snapshot":{"0":{"range":[[2,4],[2,4]],"properties":{"type":"selection","editorId":4,"goalScreenRange":null},"reversed":true,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"change","content":{"oldRange":[[2,2],[2,4]],"newRange":[[2,2],[2,6]],"oldText":"En","newText":"Enum"}},{"type":"group-end","snapshot":{"0":{"range":[[2,6],[2,6]],"properties":{"type":"selection","editorId":4,"goalScreenRange":null,"clip":"forward"},"reversed":true,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"group-start","snapshot":{"0":{"range":[[2,6],[2,6]],"properties":{"type":"selection","editorId":4,"goalScreenRange":null,"clip":"forward"},"reversed":true,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"change","content":{"oldRange":[[2,6],[2,6]],"newRange":[[2,6],[2,7]],"oldText":"","newText":"."}},{"type":"group-end","snapshot":{"0":{"range":[[2,7],[2,7]],"properties":{"type":"selection","editorId":4,"goalScreenRange":null,"clip":"forward"},"reversed":true,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"group-start","snapshot":{"0":{"range":[[2,7],[2,7]],"properties":{"type":"selection","editorId":4,"goalScreenRange":null,"clip":"forward"},"reversed":true,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"change","content":{"oldRange":[[2,7],[2,7]],"newRange":[[2,7],[2,17]],"oldText":"","newText":"EmptyError"}},{"type":"group-end","snapshot":{"0":{"range":[[2,17],[2,17]],"properties":{"type":"selection","editorId":4,"goalScreenRange":null,"clip":"forward"},"reversed":false,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"group-start","snapshot":{"0":{"range":[[2,17],[2,17]],"properties":{"type":"selection","editorId":4,"goalScreenRange":null,"clip":"forward"},"reversed":false,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"change","content":{"oldRange":[[77,35],[77,36]],"newRange":[[77,35],[77,35]],"oldText":" ","newText":""}},{"type":"change","content":{"oldRange":[[74,4],[74,5]],"newRange":[[74,4],[74,4]],"oldText":" ","newText":""}},{"type":"change","content":{"oldRange":[[63,0],[63,6]],"newRange":[[63,0],[63,0]],"oldText":"\t\t\t\t\t\t","newText":""}},{"type":"change","content":{"oldRange":[[58,0],[58,1]],"newRange":[[58,0],[58,0]],"oldText":" ","newText":""}},{"type":"group-end","snapshot":{"0":{"range":[[2,17],[2,17]],"properties":{"type":"selection","editorId":4,"goalScreenRange":null,"clip":"forward"},"reversed":false,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"group-start","snapshot":{"0":{"range":[[2,0],[3,0]],"properties":{"type":"selection","editorId":4,"goalScreenRange":null,"clip":"forward","autoscroll":false},"reversed":false,"tailed":true,"valid":true,"invalidate":"never","maintainHistory":true}}},{"type":"change","content":{"oldRange":[[2,0],[3,0]],"newRange":[[2,0],[2,0]],"oldText":"  Enum.EmptyError\n","newText":""}},{"type":"group-end","snapshot":{"0":{"range":[[2,0],[2,0]],"properties":{"type":"selection","editorId":4,"goalScreenRange":null,"clip":"forward","autoscroll":false},"reversed":false,"tailed":false,"valid":true,"invalidate":"never","maintainHistory":true}}}],"redoStack":[]},"encoding":"utf8","filePath":"/home/iraasta/GoogleDrive/projects/esl/crawl3r/lib/db.ex","digestWhenLastPersisted":"1c3bbb161f6e4ea21e4b6cd1236d9aa0c319449a","preferredLineEnding":null,"deserializer":"TextBuffer","version":2}]},"workspace":{"deserializer":"Workspace","paneContainer":{"deserializer":"PaneContainer","version":1,"root":{"deserializer":"Pane","id":3,"items":[{"deserializer":"TextEditor","id":4,"softTabs":true,"displayBuffer":{"deserializer":"DisplayBuffer","id":5,"softWrapped":false,"tokenizedBuffer":{"deserializer":"TokenizedBuffer","bufferPath":"/home/iraasta/GoogleDrive/projects/esl/crawl3r/lib/db.ex","largeFileMode":false},"largeFileMode":false}}],"activeItemURI":"/home/iraasta/GoogleDrive/projects/esl/crawl3r/lib/db.ex","focused":true,"flexScale":1},"activePaneId":3},"packagesWithActiveGrammars":["language-elixir","language-hyperlink","language-todo"],"destroyedItemURIs":[]},"packageStates":{"linter":{"scope":"File"},"fuzzy-finder":{"/home/iraasta/GoogleDrive/projects/esl/crawl3r/lib/db.ex":1449440510995},"metrics":{"sessionLength":59438},"tabs":[{}],"tree-view":{"directoryExpansionStates":{"/home/iraasta/GoogleDrive/projects/esl/crawl3r":{"isExpanded":true,"entries":{"_build":{"isExpanded":false,"entries":{}},".git":{"isExpanded":false,"entries":{}},"config":{"isExpanded":false,"entries":{}},"deps":{"isExpanded":false,"entries":{}},"lib":{"isExpanded":true,"entries":{"apis":{"isExpanded":false,"entries":{}}}},"test":{"isExpanded":false,"entries":{}}}}},"selectedPath":"/home/iraasta/GoogleDrive/projects/esl/crawl3r/lib/db.ex","hasFocus":false,"attached":true,"scrollLeft":0,"scrollTop":0,"width":200}},"fullScreen":false}